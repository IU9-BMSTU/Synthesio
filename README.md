# Синтезирование веществ по заданным условиям

## Генетический алгоритм

Для создания веществ используется генетический алгоритм, реализованный в модуле GenAlg.py. Примеры его запуска можно найти в каталоге tests/.

## Регрессионные модели

Реализованы две различные функции предсказания вектора свойств для работы генетического алгоритма, основанные на методе линейной аппроксимации и использовании нейронной сети.

## Примеры

### Мылогенератор

В каталоге test/ представлен простой пример использования системы для создания мыла. Размерность пространства признаков равна одному. Обучающая выборка learn-soap.csv содержит 300 примеров сгенерированных автоматически. В качестве дескрипторов используется набор из семи функций OpenBabel:

- logP
- MW
- bonds
- atoms
- sbonds
- dbonds
- MR

Результат работы программы:

```
Synthesio/tests $ ./soap.py
+-----------------------------------------+-------------------+----------------+
|                  smiles                 | predicted quality | real GLB index |
+-----------------------------------------+-------------------+----------------+
| CCCCCCCCCCCCCCCCCCCCCCCCCC(=O)[O-][Na+] |  0.0313155943633  |      33.6      |
|            CCCCOC(=O)[O-][K+]           |  0.0826320864191  |      23.0      |
|             CCC(=O)[O-][K+]             |  0.0943084702773  |      20.1      |
|           CCCCCOC(=O)[O-][K+]           |   0.145349245744  |      23.5      |
|  CCCCCCCCCCCCCCCCCCCCCCCCC(=O)[O-][Na+] |    0.1966657378   |      33.1      |
+-----------------------------------------+-------------------+----------------+
```

### Предсказание logP

По аналогии с мылогенератором программа генерирует вещества с заданным logP. Используемые дескрипторы:

- MW
- bonds
- atoms
- sbonds
- dbonds
- MR

Результат работы программы (заданное значение logP=5):

```
+-----------------------------------------------------------------------------------------------+-------------------+----------------+
|                                             smiles                                            | predicted quality | real GLB index |
+-----------------------------------------------------------------------------------------------+-------------------+----------------+
|           BrN=NCN=CCO(O=)S(=O)N=NCN=NC#CN=NN=CCN=CCO(O=)S(=O)N=NCN=NCO(O=)S(=O)N=NCN          |  0.0221096602221  |     5.3631     |
| FN=NO(O=)S(=O)N=NO(O=)S(=O)(O=)S(=O)N=NC(O=)S(=O)N=NC(O=)S(=O)N=NC(O=)S(=O)CC(O=)S(=O)CN=NCCN |  0.0276092767687  |     5.4198     |
|         FN=NC(=O)OS(O=)S(=O)CO(O=)S(=O)O(O=)S(=O)S(O=)S(=O)CO(O=)S(=O)O(O=)S(=O)SC=CF         |   0.028000383123  |     6.3496     |
|            IN=NO(O=)S(=O)N=NC(=O)N(O=)S(=O)N=NCC(O=)S(=O)CO(O=)S(=O)N=NC(O=)S(=O)CN           |  0.0299230645271  |     4.8936     |
|              FN=NO(O=)S(=O)SC(O=)S(=O)CC(O=)S(=O)C(O=)S(=O)CC(O=)S(=O)CCN=NOSCCF              |  0.0318527424332  |     4.5667     |
+-----------------------------------------------------------------------------------------------+-------------------+----------------+
```
